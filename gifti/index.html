<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>GIfTI mesh</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.4.2.min.js"></script>
	<script src="http://benschmidt.org/colorbar/colorbar.js"></script>
  </head>
  <body>
    <div id="plotly" style="height: 650px;width: 800px;"></div>
	<div id="cbar" style="height: 100px;width: 800px;"></div>
    <script type="text/javascript">
      //var queries = location.search.split("?")[1];
      var queries = "file=simple_mesh.json";
      if (typeof(queries) === "undefined") {
        alert("No data!");
      }
      var query = queries.split("&");
      for (var i = 0; i < query.length; i++) {
        var datatype = query[i].split("=")[0];
        var filename = query[i].split("=")[1];
        var ext = filename.split('.').pop();
        if (ext === "js") {
          var firstScript = document.getElementsByTagName('script')[0];
          var js = document.createElement('script');
          js.src = filename;
          var data = {}, layout = {title: ""}, options = {};
          js.onload = function () {
            Plotly.newPlot("plotly", data, layout, options);
          }
          firstScript.parentNode.insertBefore(js, firstScript);
        } else {
          d3.json(filename, function(err, fig) {
            if (err) alert("Could not read data!");
            if (fig.layout === "undefined") {
              fig.layout = {title: ""};
            }
            if (fig.options === "undefined") {
              fig.options = {};
            }
			var data = [{
				i: fig.data[0].i,
				j: fig.data[0].j,
				k: fig.data[0].k,
				type: fig.data[0].type,
				vertexcolor: fig.data[0].vertexcolor,
				x: fig.data[0].x,
				y: fig.data[0].y,
				z: fig.data[0].z,
				colorbar: [[0, 'rgb(166,206,227)'], [0.25, 'rgb(31,120,180)'], [0.45, 'rgb(178,223,138)'],
				[0.65, 'rgb(51,160,44)'], [0.85, 'rgb(251,154,153)'], [1, 'rgb(227,26,28)']]
			  }
			];
            Plotly.newPlot("plotly", data, fig.layout, fig.options);
          });
        }
      }
    </script>
	<script type="text/javascript">
	myScale = d3.scale.linear().range(["blue","white","red"]).domain([-16,0,16])

colorbar = Colorbar()
	.scale(myScale)
	.orient("horizontal")
  .barlength(400)
  .thickness(40)

placeholder = "#cbar"

colorbarObject = d3.select(placeholder)
    .call(colorbar)
	</script>
  </body>
</html>
